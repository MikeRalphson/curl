# Server-side
<reply>
<data1>
HTTP/1.1 200 OK
Date: Thu, 09 Nov 2010 14:49:00 GMT
Server: test-server/fake
Content-Type: text/html
Set-Cookie: test1=one; domain=foo.com; expires=Tue Feb 1 11:56:27 MET 2007
Set-Cookie: test2=two; domain=host.foo.com; expires=Tue Feb 1 11:56:27 MET 2007
Set-Cookie: test3=three; domain=foo.com; expires=Tue Feb 1 11:56:27 MET 2007
Content-Length: 29

run 1: set cookie 1, 2 and 3
</data1>
<data2>
HTTP/1.1 200 OK
Date: Thu, 09 Nov 2010 14:49:01 GMT
Server: test-server/fake
Content-Type: text/html
Set-Cookie: test4=four; domain=host.foo.com; expires=Tue Feb 1 11:56:27 MET 2007
Set-Cookie: test5=five; domain=host.foo.com; expires=Tue Feb 1 11:56:27 MET 2007
Content-Length: 26

run 2: set cookie 4 and 5
</data2>
<data3>
HTTP/1.1 200 OK
Date: Thu, 09 Nov 2010 14:49:02 GMT
Server: test-server/fake
Content-Type: text/html
Funny-head: yesyes
Set-Cookie: test4=overwritten4; domain=host.foo.com; expires=Thu Dec 31 23:59:59 MET 2009
Set-Cookie: test1=overwritten1; domain=foo.com; expires=Tue Feb 2 11:56:27 MET 2007
Content-Type: text/html
Content-Length: 32

run 3: overwrite cookie 1 and 4
</data5>
</reply>

# Client-side
<client>
<server>
http
</server>
<name>
HTTP with shared cookie list (and dns cache)
</name>
<tool>
lib506
</tool>
<command>
http://%HOSTIP:%HOSTPORT/506
</command>
</client>

# Verify data after the test has been "shot"
<verify>
<stdout>
GLOBAL_INIT
SHARE_INIT
CURL_LOCK_DATA_COOKIE
CURL_LOCK_DATA_DNS
*** run 1
CURLOPT_SHARE
lock:   share   <Pigs in space>
unlock: share   <Pigs in space>
PERFORM
lock:   dns     <Pigs in space>
unlock: dns     <Pigs in space>
lock:   cookie  <Pigs in space>
unlock: cookie  <Pigs in space>
lock:   cookie  <Pigs in space>
unlock: cookie  <Pigs in space>
lock:   cookie  <Pigs in space>
unlock: cookie  <Pigs in space>
lock:   cookie  <Pigs in space>
unlock: cookie  <Pigs in space>
run 1: set cookie 1, 2 and 3
lock:   dns     <Pigs in space>
unlock: dns     <Pigs in space>
CLEANUP
lock:   cookie  <Pigs in space>
unlock: cookie  <Pigs in space>
*** run 2
CURLOPT_SHARE
lock:   share   <Pigs in space>
unlock: share   <Pigs in space>
PERFORM
lock:   dns     <Pigs in space>
unlock: dns     <Pigs in space>
lock:   cookie  <Pigs in space>
unlock: cookie  <Pigs in space>
lock:   cookie  <Pigs in space>
unlock: cookie  <Pigs in space>
lock:   cookie  <Pigs in space>
unlock: cookie  <Pigs in space>
run 2: set cookie 4 and 5
lock:   dns     <Pigs in space>
unlock: dns     <Pigs in space>
CLEANUP
lock:   cookie  <Pigs in space>
unlock: cookie  <Pigs in space>
*** run 3
CURLOPT_SHARE
lock:   share   <Pigs in space>
unlock: share   <Pigs in space>
CURLOPT_COOKIEJAR
PERFORM
lock:   dns     <Pigs in space>
unlock: dns     <Pigs in space>
lock:   cookie  <Pigs in space>
unlock: cookie  <Pigs in space>
lock:   cookie  <Pigs in space>
unlock: cookie  <Pigs in space>
lock:   cookie  <Pigs in space>
unlock: cookie  <Pigs in space>
run 3: overwrite cookie 1 and 4
lock:   dns     <Pigs in space>
unlock: dns     <Pigs in space>
try SHARE_CLEANUP...
lock:   share   <Pigs in space>
unlock: share   <Pigs in space>
SHARE_CLEANUP failed, correct
CLEANUP
lock:   cookie  <Pigs in space>
unlock: cookie  <Pigs in space>
SHARE_CLEANUP
lock:   share   <Pigs in space>
unlock: share   <Pigs in space>
GLOBAL_CLEANUP
</stdout>
<stderr>
http://%HOSTIP:%HOSTPORT/506 
</stderr>
<file name="log/jar506">
# Netscape HTTP Cookie File
# http://www.netscape.com/newsref/std/cookie_spec.html
# This file was generated by libcurl! Edit at your own risk.

.foo.com	TRUE	/	FALSE	1170413787	test1	overwritten1
.host.foo.com	TRUE	/	FALSE	1170327387	test2	two
.foo.com	TRUE	/	FALSE	1170327387	test3	three
.host.foo.com	TRUE	/	FALSE	1262300399	test4	overwritten4
.host.foo.com	TRUE	/	FALSE	1170327387	test5	five
</file>
</verify>
